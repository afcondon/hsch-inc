// Generated by purs version 0.15.15
import * as $foreign from "./foreign.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Maybe.applicativeMaybe);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var swizzleLinks = function (nodes) {
    return function (links) {
        return function (transform) {
            var swizzle = function (link) {
                return bind(Data_Array.index(nodes)(link.source))(function (src) {
                    return bind(Data_Array.index(nodes)(link.target))(function (tgt) {
                        return pure({
                            src: src,
                            tgt: tgt,
                            link: link
                        });
                    });
                });
            };
            var reindex = function (i) {
                return function (v) {
                    return transform(v.src)(v.tgt)(i)(v.link);
                };
            };
            return Data_Array.mapWithIndex(reindex)(Data_Array.mapMaybe(swizzle)(links));
        };
    };
};
var intMapLookup = function (key) {
    return function (m) {
        var result = $foreign.intMapLookup_(key)(m);
        var $11 = $foreign.isNull(result);
        if ($11) {
            return Data_Maybe.Nothing.value;
        };
        return new Data_Maybe.Just(result);
    };
};
var filterLinksToSubset = function (getIndex) {
    return function (nodes) {
        return function (links) {
            var nodeIndices = $foreign.buildIntSet(map(getIndex)(nodes));
            return Data_Array.filter(function (l) {
                return $foreign.intSetMember(l.source)(nodeIndices) && $foreign.intSetMember(l.target)(nodeIndices);
            })(links);
        };
    };
};
var buildIntMap = function (getIndex) {
    return function (nodes) {
        return $foreign.buildIntMap_(map(function (n) {
            return {
                key: getIndex(n),
                value: n
            };
        })(nodes));
    };
};
var swizzleLinksByIndex = function (getIndex) {
    return function (nodes) {
        return function (links) {
            return function (transform) {
                var swizzle = function (nodeMap) {
                    return function (link) {
                        return bind(intMapLookup(link.source)(nodeMap))(function (srcNode) {
                            return bind(intMapLookup(link.target)(nodeMap))(function (tgtNode) {
                                return pure({
                                    src: srcNode,
                                    tgt: tgtNode,
                                    link: link
                                });
                            });
                        });
                    };
                };
                var reindex = function (i) {
                    return function (v) {
                        return transform(v.src)(v.tgt)(i)(v.link);
                    };
                };
                var nodeMap = buildIntMap(getIndex)(nodes);
                return Data_Array.mapWithIndex(reindex)(Data_Array.mapMaybe(swizzle(nodeMap))(links));
            };
        };
    };
};
export {
    buildIntSet,
    intSetMember,
    buildStringSet,
    stringSetMember
} from "./foreign.js";
export {
    swizzleLinks,
    swizzleLinksByIndex,
    filterLinksToSubset,
    buildIntMap,
    intMapLookup
};
//# sourceMappingURL=index.js.map
