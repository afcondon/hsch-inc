// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Graph_Layout from "../Data.Graph.Layout/index.js";
import * as Data_Map_Internal from "../Data.Map.Internal/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Ordering from "../Data.Ordering/index.js";
import * as Data_Set from "../Data.Set/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Data_Unfoldable from "../Data.Unfoldable/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Hylograph_HATS from "../Hylograph.HATS/index.js";
import * as Hylograph_HATS_InterpreterTick from "../Hylograph.HATS.InterpreterTick/index.js";
import * as Hylograph_Internal_Selection_Types from "../Hylograph.Internal.Selection.Types/index.js";
var mapFlipped = /* #__PURE__ */ Data_Functor.mapFlipped(Data_Functor.functorArray);
var toUnfoldable = /* #__PURE__ */ Data_Set.toUnfoldable(Data_Unfoldable.unfoldableArray);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var sort = /* #__PURE__ */ Data_Array.sort(Data_Ord.ordNumber);
var Cata = /* #__PURE__ */ (function () {
    function Cata() {

    };
    Cata.value = new Cata();
    return Cata;
})();
var Ana = /* #__PURE__ */ (function () {
    function Ana() {

    };
    Ana.value = new Ana();
    return Ana;
})();
var Hylo = /* #__PURE__ */ (function () {
    function Hylo() {

    };
    Hylo.value = new Hylo();
    return Hylo;
})();
var Para = /* #__PURE__ */ (function () {
    function Para() {

    };
    Para.value = new Para();
    return Para;
})();
var Apo = /* #__PURE__ */ (function () {
    function Apo() {

    };
    Apo.value = new Apo();
    return Apo;
})();
var Histo = /* #__PURE__ */ (function () {
    function Histo() {

    };
    Histo.value = new Histo();
    return Histo;
})();
var Futu = /* #__PURE__ */ (function () {
    function Futu() {

    };
    Futu.value = new Futu();
    return Futu;
})();
var Zygo = /* #__PURE__ */ (function () {
    function Zygo() {

    };
    Zygo.value = new Zygo();
    return Zygo;
})();
var showMorphism = {
    show: function (v) {
        if (v instanceof Cata) {
            return "cata";
        };
        if (v instanceof Ana) {
            return "ana";
        };
        if (v instanceof Hylo) {
            return "hylo";
        };
        if (v instanceof Para) {
            return "para";
        };
        if (v instanceof Apo) {
            return "apo";
        };
        if (v instanceof Histo) {
            return "histo";
        };
        if (v instanceof Futu) {
            return "futu";
        };
        if (v instanceof Zygo) {
            return "zygo";
        };
        throw new Error("Failed pattern match at Zoo.MorphismDAG (line 33, column 1 - line 41, column 21): " + [ v.constructor.name ]);
    }
};
var show1 = /* #__PURE__ */ Data_Show.show(showMorphism);
var morphismTextColor = function (v) {
    if (v instanceof Histo) {
        return "#2D3436";
    };
    return "white";
};
var morphismColor = function (v) {
    if (v instanceof Cata) {
        return "#FF6B35";
    };
    if (v instanceof Ana) {
        return "#4D8BF5";
    };
    if (v instanceof Hylo) {
        return "#845EC2";
    };
    if (v instanceof Para) {
        return "#00B4A0";
    };
    if (v instanceof Apo) {
        return "#FF78AE";
    };
    if (v instanceof Histo) {
        return "#FFD93D";
    };
    if (v instanceof Futu) {
        return "#FF6B35";
    };
    if (v instanceof Zygo) {
        return "#2ECC71";
    };
    throw new Error("Failed pattern match at Zoo.MorphismDAG (line 59, column 17 - line 67, column 20): " + [ v.constructor.name ]);
};
var nodeTree = function (pos) {
    return function (isSelected) {
        var textColor = morphismTextColor(pos.morphism);
        var strokeWidth = (function () {
            if (isSelected) {
                return 4.0;
            };
            return 2.0;
        })();
        var radius = (function () {
            if (isSelected) {
                return 22.0;
            };
            return 18.0;
        })();
        var color = morphismColor(pos.morphism);
        return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("class")("dag-node" + (function () {
            if (isSelected) {
                return " selected";
            };
            return "";
        })()), Hylograph_HATS.staticStr("cursor")("pointer") ])([ Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Circle.value)([ Hylograph_HATS.staticNum("cx")(pos.x), Hylograph_HATS.staticNum("cy")(pos.y), Hylograph_HATS.staticNum("r")(radius), Hylograph_HATS.staticStr("fill")(color), Hylograph_HATS.staticStr("stroke")("#2D3436"), Hylograph_HATS.staticNum("stroke-width")(strokeWidth) ])([  ]), Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Text.value)([ Hylograph_HATS.staticNum("x")(pos.x), Hylograph_HATS.staticNum("y")(pos.y + 4.0), Hylograph_HATS.staticStr("text-anchor")("middle"), Hylograph_HATS.staticStr("font-family")("'Comic Sans MS', cursive"), Hylograph_HATS.staticNum("font-size")(10.0), Hylograph_HATS.staticStr("font-weight")("bold"), Hylograph_HATS.staticStr("fill")(textColor), Hylograph_HATS.staticStr("stroke")("#2D3436"), Hylograph_HATS.staticNum("stroke-width")(0.5), Hylograph_HATS.staticStr("paint-order")("stroke fill"), Hylograph_HATS.staticStr("textContent")(show1(pos.morphism)) ])([  ]) ]);
    };
};
var eqMorphism = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Cata && y instanceof Cata) {
                return true;
            };
            if (x instanceof Ana && y instanceof Ana) {
                return true;
            };
            if (x instanceof Hylo && y instanceof Hylo) {
                return true;
            };
            if (x instanceof Para && y instanceof Para) {
                return true;
            };
            if (x instanceof Apo && y instanceof Apo) {
                return true;
            };
            if (x instanceof Histo && y instanceof Histo) {
                return true;
            };
            if (x instanceof Futu && y instanceof Futu) {
                return true;
            };
            if (x instanceof Zygo && y instanceof Zygo) {
                return true;
            };
            return false;
        };
    }
};
var eq = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(eqMorphism));
var nodesTree = function (positioned) {
    return function (selected) {
        return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("class")("dag-nodes") ])(mapFlipped(positioned)(function (p) {
            return nodeTree(p)(eq(selected)(new Data_Maybe.Just(p.morphism)));
        }));
    };
};
var ordMorphism = {
    compare: function (x) {
        return function (y) {
            if (x instanceof Cata && y instanceof Cata) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Cata) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Cata) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Ana && y instanceof Ana) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Ana) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Ana) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Hylo && y instanceof Hylo) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Hylo) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Hylo) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Para && y instanceof Para) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Para) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Para) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Apo && y instanceof Apo) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Apo) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Apo) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Histo && y instanceof Histo) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Histo) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Histo) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Futu && y instanceof Futu) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Futu) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Futu) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Zygo && y instanceof Zygo) {
                return Data_Ordering.EQ.value;
            };
            throw new Error("Failed pattern match at Zoo.MorphismDAG (line 0, column 0 - line 0, column 0): " + [ x.constructor.name, y.constructor.name ]);
        };
    },
    Eq0: function () {
        return eqMorphism;
    }
};
var fromFoldable = /* #__PURE__ */ Data_Map_Internal.fromFoldable(ordMorphism)(Data_Foldable.foldableArray);
var fromFoldable1 = /* #__PURE__ */ Data_Set.fromFoldable(Data_Foldable.foldableArray)(ordMorphism);
var lookup = /* #__PURE__ */ Data_Map_Internal.lookup(ordMorphism);
var morphismEdges = /* #__PURE__ */ (function () {
    return fromFoldable([ new Data_Tuple.Tuple(Cata.value, fromFoldable1([ Para.value, Hylo.value ])), new Data_Tuple.Tuple(Ana.value, fromFoldable1([ Apo.value, Hylo.value ])), new Data_Tuple.Tuple(Para.value, fromFoldable1([ Histo.value, Zygo.value ])), new Data_Tuple.Tuple(Apo.value, fromFoldable1([ Futu.value ])) ]);
})();
var edgeTree = function (v) {
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Line.value)([ Hylograph_HATS.staticNum("x1")(v.from.x), Hylograph_HATS.staticNum("y1")(v.from.y), Hylograph_HATS.staticNum("x2")(v.to.x), Hylograph_HATS.staticNum("y2")(v.to.y), Hylograph_HATS.staticStr("stroke")("#2D3436"), Hylograph_HATS.staticNum("stroke-width")(2.0), Hylograph_HATS.staticStr("marker-end")("url(#dag-arrow)") ])([  ]);
};
var edgesTree = function (positioned) {
    var posMap = fromFoldable(mapFlipped(positioned)(function (p) {
        return new Data_Tuple.Tuple(p.morphism, p);
    }));
    var edges = Data_Array.concatMap(function (p) {
        var targets = Data_Maybe.fromMaybe(Data_Set.empty)(lookup(p.morphism)(morphismEdges));
        return Data_Array.mapMaybe(function (target) {
            var v = lookup(target)(posMap);
            if (v instanceof Data_Maybe.Nothing) {
                return Data_Maybe.Nothing.value;
            };
            if (v instanceof Data_Maybe.Just) {
                return new Data_Maybe.Just({
                    from: p,
                    to: v.value0
                });
            };
            throw new Error("Failed pattern match at Zoo.MorphismDAG (line 170, column 12 - line 172, column 63): " + [ v.constructor.name ]);
        })(toUnfoldable(targets));
    })(positioned);
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("class")("dag-edges") ])(mapFlipped(edges)(edgeTree));
};
var defsTree = /* #__PURE__ */ (function () {
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Defs.value)([  ])([ Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("id")("dag-arrow") ])([ Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Path.value)([ Hylograph_HATS.staticStr("d")("M0,0 L0,6 L9,3 z"), Hylograph_HATS.staticStr("fill")("#2D3436") ])([  ]) ]) ]);
})();
var dagTree = function (positioned) {
    return function (selected) {
        return function (offX) {
            return function (offY) {
                return function (width) {
                    return function (height) {
                        return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.SVG.value)([ Hylograph_HATS.staticStr("viewBox")(show(offX) + (" " + (show(offY) + (" " + (show(width) + (" " + show(height))))))), Hylograph_HATS.staticStr("class")("morphism-dag-svg"), Hylograph_HATS.staticStr("width")("100%"), Hylograph_HATS.staticStr("preserveAspectRatio")("xMidYMid meet") ])([ defsTree, edgesTree(positioned), nodesTree(positioned)(selected) ]);
                    };
                };
            };
        };
    };
};
var dagLayoutConfig = /* #__PURE__ */ (function () {
    return {
        nodeWidth: 70.0,
        nodeHeight: 80.0,
        orientation: Data_Graph_Layout.Horizontal.value,
        reversed: true
    };
})();
var allMorphisms = /* #__PURE__ */ (function () {
    return [ Cata.value, Ana.value, Hylo.value, Para.value, Apo.value, Histo.value, Futu.value, Zygo.value ];
})();
var layoutMorphisms = /* #__PURE__ */ (function () {
    var layoutNodes = Data_Graph_Layout.dagLayout(ordMorphism)(dagLayoutConfig)(allMorphisms)(morphismEdges);
    return mapFlipped(layoutNodes)(function (node) {
        return {
            morphism: node.id,
            x: node.x,
            y: node.y,
            layer: node.layer
        };
    });
})();
var renderMorphismDAG = function (selector) {
    return function (selected) {
        return function (onClick) {
            var xs = mapFlipped(layoutMorphisms)(function (v) {
                return v.x;
            });
            var ys = mapFlipped(layoutMorphisms)(function (v) {
                return v.y;
            });
            var minY = Data_Maybe.fromMaybe(0.0)(Data_Array.head(sort(ys))) - 50.0;
            var minX = Data_Maybe.fromMaybe(0.0)(Data_Array.head(sort(xs))) - 50.0;
            var maxY = Data_Maybe.fromMaybe(0.0)(Data_Array.last(sort(ys))) + 50.0;
            var maxX = Data_Maybe.fromMaybe(0.0)(Data_Array.last(sort(xs))) + 50.0;
            var width = maxX - minX;
            var height = maxY - minY;
            var tree = dagTree(layoutMorphisms)(selected)(minX)(minY)(width)(height);
            return function __do() {
                Hylograph_HATS_InterpreterTick.rerender(selector)(tree)();
                return Data_Unit.unit;
            };
        };
    };
};
export {
    Cata,
    Ana,
    Hylo,
    Para,
    Apo,
    Histo,
    Futu,
    Zygo,
    allMorphisms,
    morphismEdges,
    morphismColor,
    morphismTextColor,
    dagLayoutConfig,
    layoutMorphisms,
    renderMorphismDAG,
    dagTree,
    defsTree,
    edgesTree,
    edgeTree,
    nodesTree,
    nodeTree,
    eqMorphism,
    ordMorphism,
    showMorphism
};
//# sourceMappingURL=index.js.map
