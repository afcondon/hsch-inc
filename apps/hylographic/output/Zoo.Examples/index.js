// Generated by purs version 0.15.15
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Zoo_Schemes from "../Zoo.Schemes/index.js";
import * as Zoo_Types from "../Zoo.Types/index.js";
var ana = /* #__PURE__ */ Zoo_Schemes.ana(Zoo_Types.functorListF);
var hylo = /* #__PURE__ */ Zoo_Schemes.hylo(Zoo_Types.functorListF);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var cata = /* #__PURE__ */ Zoo_Schemes.cata(Zoo_Types.functorExprF);
var apo = /* #__PURE__ */ Zoo_Schemes.apo(Zoo_Types.functorListF);
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordInt);
var cata1 = /* #__PURE__ */ Zoo_Schemes.cata(Zoo_Types.functorTreeF);
var replicateCoalgebra = function (v) {
    if (v.value1 === 0) {
        return Zoo_Types.NilF.value;
    };
    return new Zoo_Types.ConsF(v.value0, new Data_Tuple.Tuple(v.value0, v.value1 - 1 | 0));
};
var replicate = function (n) {
    return function (x) {
        return ana(replicateCoalgebra)(new Data_Tuple.Tuple(x, n));
    };
};
var rangeCoalgebra = function (n) {
    if (n <= 0) {
        return Zoo_Types.NilF.value;
    };
    if (Data_Boolean.otherwise) {
        return new Zoo_Types.ConsF(n, n - 1 | 0);
    };
    throw new Error("Failed pattern match at Zoo.Examples (line 67, column 1 - line 67, column 39): " + [ n.constructor.name ]);
};
var sumRange = /* #__PURE__ */ (function () {
    var sumAlgebra = function (v) {
        if (v instanceof Zoo_Types.NilF) {
            return 0;
        };
        if (v instanceof Zoo_Types.ConsF) {
            return v.value0 + v.value1 | 0;
        };
        throw new Error("Failed pattern match at Zoo.Examples (line 108, column 3 - line 108, column 37): " + [ v.constructor.name ]);
    };
    return hylo(sumAlgebra)(rangeCoalgebra);
})();
var range = /* #__PURE__ */ ana(rangeCoalgebra);
var prettyAlgebra = function (v) {
    if (v instanceof Zoo_Types.LitF) {
        return show(v.value0);
    };
    if (v instanceof Zoo_Types.AddF) {
        return "(" + (v.value0 + (" + " + (v.value1 + ")")));
    };
    if (v instanceof Zoo_Types.MulF) {
        return "(" + (v.value0 + (" \xd7 " + (v.value1 + ")")));
    };
    if (v instanceof Zoo_Types.SubF) {
        return "(" + (v.value0 + (" - " + (v.value1 + ")")));
    };
    throw new Error("Failed pattern match at Zoo.Examples (line 31, column 17 - line 35, column 44): " + [ v.constructor.name ]);
};
var pretty = /* #__PURE__ */ cata(prettyAlgebra);
var natToInt = /* #__PURE__ */ (function () {
    var alg = function (v) {
        if (v instanceof Zoo_Types.ZeroF) {
            return 0;
        };
        if (v instanceof Zoo_Types.SuccF) {
            return v.value0 + 1 | 0;
        };
        throw new Error("Failed pattern match at Zoo.Examples (line 134, column 3 - line 134, column 16): " + [ v.constructor.name ]);
    };
    return Zoo_Schemes.cata(Zoo_Types.functorNatF)(alg);
})();
var insertSorted = function (x) {
    var coalgebra = function (v) {
        if (v instanceof Zoo_Types.NilF) {
            return new Zoo_Types.ConsF(x, new Zoo_Schemes.Left(Zoo_Types.nil));
        };
        if (v instanceof Zoo_Types.ConsF) {
            if (x <= v.value0) {
                return new Zoo_Types.ConsF(x, new Zoo_Schemes.Left(v));
            };
            if (Data_Boolean.otherwise) {
                return new Zoo_Types.ConsF(v.value0, new Zoo_Schemes.Right(v.value1));
            };
        };
        throw new Error("Failed pattern match at Zoo.Examples (line 148, column 3 - line 148, column 71): " + [ v.constructor.name ]);
    };
    return apo(coalgebra);
};
var fibHisto = /* #__PURE__ */ (function () {
    var algebra = function (v) {
        if (v instanceof Zoo_Types.ZeroF) {
            return 0;
        };
        if (v instanceof Zoo_Types.SuccF) {
            var v1 = Zoo_Schemes.unwrap(v.value0);
            if (v1 instanceof Zoo_Types.ZeroF) {
                return 1;
            };
            if (v1 instanceof Zoo_Types.SuccF) {
                return Zoo_Schemes.extract(v.value0) + Zoo_Schemes.extract(v1.value0) | 0;
            };
            throw new Error("Failed pattern match at Zoo.Examples (line 176, column 5 - line 178, column 56): " + [ v1.constructor.name ]);
        };
        throw new Error("Failed pattern match at Zoo.Examples (line 173, column 3 - line 173, column 43): " + [ v.constructor.name ]);
    };
    return Zoo_Schemes.histo(Zoo_Types.functorNatF)(algebra);
})();
var factorialPara = /* #__PURE__ */ (function () {
    var algebra = function (v) {
        if (v instanceof Zoo_Types.ZeroF) {
            return 1;
        };
        if (v instanceof Zoo_Types.SuccF) {
            return (natToInt(v.value0.value0) + 1 | 0) * v.value0.value1 | 0;
        };
        throw new Error("Failed pattern match at Zoo.Examples (line 126, column 3 - line 126, column 41): " + [ v.constructor.name ]);
    };
    return Zoo_Schemes.para(Zoo_Types.functorNatF)(algebra);
})();
var factorialHylo = /* #__PURE__ */ (function () {
    var productAlgebra = function (v) {
        if (v instanceof Zoo_Types.NilF) {
            return 1;
        };
        if (v instanceof Zoo_Types.ConsF) {
            return v.value0 * v.value1 | 0;
        };
        throw new Error("Failed pattern match at Zoo.Examples (line 100, column 3 - line 100, column 41): " + [ v.constructor.name ]);
    };
    return hylo(productAlgebra)(rangeCoalgebra);
})();
var hyloExample = {
    input: 4,
    intermediate: "[4, 3, 2, 1]",
    result: /* #__PURE__ */ factorialHylo(4)
};
var exampleExpr = /* #__PURE__ */ Zoo_Types.add(/* #__PURE__ */ Zoo_Types.mul(/* #__PURE__ */ Zoo_Types.lit(2))(/* #__PURE__ */ Zoo_Types.lit(3)))(/* #__PURE__ */ Zoo_Types.sub(/* #__PURE__ */ Zoo_Types.lit(10))(/* #__PURE__ */ Zoo_Types.lit(2)));
var evalAlgebra = function (v) {
    if (v instanceof Zoo_Types.LitF) {
        return v.value0;
    };
    if (v instanceof Zoo_Types.AddF) {
        return v.value0 + v.value1 | 0;
    };
    if (v instanceof Zoo_Types.MulF) {
        return v.value0 * v.value1 | 0;
    };
    if (v instanceof Zoo_Types.SubF) {
        return v.value0 - v.value1 | 0;
    };
    throw new Error("Failed pattern match at Zoo.Examples (line 20, column 15 - line 24, column 20): " + [ v.constructor.name ]);
};
var $$eval = /* #__PURE__ */ cata(evalAlgebra);
var depthAlgebra = function (v) {
    if (v instanceof Zoo_Types.LeafF) {
        return 0;
    };
    if (v instanceof Zoo_Types.BranchF) {
        return 1 + max(v.value0)(v.value1) | 0;
    };
    throw new Error("Failed pattern match at Zoo.Examples (line 51, column 16 - line 53, column 29): " + [ v.constructor.name ]);
};
var depth = /* #__PURE__ */ cata1(depthAlgebra);
var countAlgebra = function (v) {
    if (v instanceof Zoo_Types.LeafF) {
        return 1;
    };
    if (v instanceof Zoo_Types.BranchF) {
        return (1 + v.value0 | 0) + v.value1 | 0;
    };
    throw new Error("Failed pattern match at Zoo.Examples (line 42, column 16 - line 44, column 27): " + [ v.constructor.name ]);
};
var countNodes = /* #__PURE__ */ cata1(countAlgebra);
var cataExample = {
    expr: exampleExpr,
    result: /* #__PURE__ */ $$eval(exampleExpr),
    steps: [ "Evaluate leaves: 2, 3, 10, 2", "Compute (2 \xd7 3) = 6, (10 - 2) = 8", "Compute 6 + 8 = 14" ]
};
var buildUntil = function (limit) {
    return function (n) {
        var coalgebra = function (i) {
            if (i <= 0) {
                return Zoo_Types.NilF.value;
            };
            if (i > limit) {
                return new Zoo_Types.ConsF(i, new Zoo_Schemes.Left(Zoo_Types.nil));
            };
            if (Data_Boolean.otherwise) {
                return new Zoo_Types.ConsF(i, new Zoo_Schemes.Right(i - 1 | 0));
            };
            throw new Error("Failed pattern match at Zoo.Examples (line 158, column 3 - line 158, column 57): " + [ i.constructor.name ]);
        };
        return apo(coalgebra)(n);
    };
};
var balancedCoalgebra = function (n) {
    if (n <= 0) {
        return new Zoo_Types.LeafF(0);
    };
    if (Data_Boolean.otherwise) {
        return new Zoo_Types.BranchF(n - 1 | 0, n - 1 | 0);
    };
    throw new Error("Failed pattern match at Zoo.Examples (line 76, column 1 - line 76, column 42): " + [ n.constructor.name ]);
};
var balancedTree = /* #__PURE__ */ Zoo_Schemes.ana(Zoo_Types.functorTreeF)(balancedCoalgebra);
var anaExample = {
    seed: 4,
    result: "4 \u2192 3 \u2192 2 \u2192 1 \u2192 nil"
};
export {
    evalAlgebra,
    $$eval as eval,
    prettyAlgebra,
    pretty,
    countAlgebra,
    countNodes,
    depthAlgebra,
    depth,
    exampleExpr,
    rangeCoalgebra,
    range,
    balancedCoalgebra,
    balancedTree,
    replicateCoalgebra,
    replicate,
    factorialHylo,
    sumRange,
    factorialPara,
    natToInt,
    insertSorted,
    buildUntil,
    fibHisto,
    cataExample,
    anaExample,
    hyloExample
};
//# sourceMappingURL=index.js.map
