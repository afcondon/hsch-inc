// Generated by purs version 0.15.15
import * as $foreign from "./foreign.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_HeytingAlgebra from "../Data.HeytingAlgebra/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Traversable from "../Data.Traversable/index.js";
import * as Effect from "../Effect/index.js";
import * as Hylograph_Internal_Transition_Types from "../Hylograph.Internal.Transition.Types/index.js";
import * as Hylograph_Transition_Tick from "../Hylograph.Transition.Tick/index.js";
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordNumber);
var all = /* #__PURE__ */ Data_Foldable.all(Data_Foldable.foldableArray)(Data_HeytingAlgebra.heytingAlgebraBoolean);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var traverse = /* #__PURE__ */ Data_Traversable.traverse(Data_Traversable.traversableArray)(Effect.applicativeEffect);
var HATSTransitions = function (x) {
    return x;
};
var Running = /* #__PURE__ */ (function () {
    function Running(value0) {
        this.value0 = value0;
    };
    Running.create = function (value0) {
        return new Running(value0);
    };
    return Running;
})();
var Complete = /* #__PURE__ */ (function () {
    function Complete() {

    };
    Complete.value = new Complete();
    return Complete;
})();
var toTickEasing = function (v) {
    if (v instanceof Data_Maybe.Nothing) {
        return Hylograph_Transition_Tick.easeOutCubic;
    };
    if (v instanceof Data_Maybe.Just) {
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Linear) {
            return Hylograph_Transition_Tick.linear;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Cubic) {
            return Hylograph_Transition_Tick.easeOutCubic;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.CubicIn) {
            return Hylograph_Transition_Tick.easeInCubic;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.CubicOut) {
            return Hylograph_Transition_Tick.easeOutCubic;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.CubicInOut) {
            return Hylograph_Transition_Tick.easeInOutCubic;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Quad) {
            return Hylograph_Transition_Tick.easeOutQuad;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.QuadIn) {
            return Hylograph_Transition_Tick.easeInQuad;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.QuadOut) {
            return Hylograph_Transition_Tick.easeOutQuad;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.QuadInOut) {
            return Hylograph_Transition_Tick.easeInOutQuad;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Sin) {
            return Hylograph_Transition_Tick.easeOutSin;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.SinIn) {
            return Hylograph_Transition_Tick.easeInSin;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.SinOut) {
            return Hylograph_Transition_Tick.easeOutSin;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.SinInOut) {
            return Hylograph_Transition_Tick.easeInOutSin;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Exp) {
            return Hylograph_Transition_Tick.easeOutExp;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.ExpIn) {
            return Hylograph_Transition_Tick.easeInExp;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.ExpOut) {
            return Hylograph_Transition_Tick.easeOutExp;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.ExpInOut) {
            return Hylograph_Transition_Tick.easeInOutExp;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Circle) {
            return Hylograph_Transition_Tick.easeOutCircle;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.CircleIn) {
            return Hylograph_Transition_Tick.easeInCircle;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.CircleOut) {
            return Hylograph_Transition_Tick.easeOutCircle;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.CircleInOut) {
            return Hylograph_Transition_Tick.easeInOutCircle;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Elastic) {
            return Hylograph_Transition_Tick.easeOutElastic;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.ElasticIn) {
            return Hylograph_Transition_Tick.easeInElastic;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.ElasticOut) {
            return Hylograph_Transition_Tick.easeOutElastic;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.ElasticInOut) {
            return Hylograph_Transition_Tick.easeInOutElastic;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Back) {
            return Hylograph_Transition_Tick.easeOutBack;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.BackIn) {
            return Hylograph_Transition_Tick.easeInBack;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.BackOut) {
            return Hylograph_Transition_Tick.easeOutBack;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.BackInOut) {
            return Hylograph_Transition_Tick.easeInOutBack;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.Bounce) {
            return Hylograph_Transition_Tick.easeOutBounce;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.BounceIn) {
            return Hylograph_Transition_Tick.easeInBounce;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.BounceOut) {
            return Hylograph_Transition_Tick.easeOutBounce;
        };
        if (v.value0 instanceof Hylograph_Internal_Transition_Types.BounceInOut) {
            return Hylograph_Transition_Tick.easeInOutBounce;
        };
        throw new Error("Failed pattern match at Hylograph.HATS.Transitions (line 187, column 13 - line 220, column 45): " + [ v.value0.constructor.name ]);
    };
    throw new Error("Failed pattern match at Hylograph.HATS.Transitions (line 185, column 16 - line 220, column 45): " + [ v.constructor.name ]);
};
var tickAttr = function (deltaMs) {
    return function (attr) {
        return {
            attrName: attr.attrName,
            from: attr.from,
            to: attr.to,
            duration: attr.duration,
            delay: attr.delay,
            easing: attr.easing,
            elapsed: attr.elapsed + deltaMs
        };
    };
};
var currentAttrValue = function (attr) {
    var effectiveElapsed = max(0.0)(attr.elapsed - attr.delay);
    var rawProgress = (function () {
        var $25 = attr.duration <= 0.0;
        if ($25) {
            return 1.0;
        };
        return min(1.0)(effectiveElapsed / attr.duration);
    })();
    var easedProgress = attr.easing(rawProgress);
    return Hylograph_Transition_Tick.lerp(attr.from)(attr.to)(easedProgress);
};
var attrComplete = function (attr) {
    return attr.elapsed >= attr.duration + attr.delay;
};
var elementComplete = function (et) {
    return all(attrComplete)(et.attrs);
};
var isComplete = function (v) {
    return all(elementComplete)(v.entering) && (all(elementComplete)(v.updating) && all(elementComplete)(v.exiting));
};
var applyAttr = function (el) {
    return function (attr) {
        var value = currentAttrValue(attr);
        return $foreign.setAttribute(el)(attr.attrName)(show(value));
    };
};
var tickElement = function (deltaMs) {
    return function (et) {
        var attrs$prime = map(tickAttr(deltaMs))(et.attrs);
        return function __do() {
            traverse(applyAttr(et.element))(attrs$prime)();
            return {
                element: et.element,
                attrs: attrs$prime
            };
        };
    };
};
var tickTransitions = function (deltaMs) {
    return function (v) {
        return function __do() {
            var entering$prime = traverse(tickElement(deltaMs))(v.entering)();
            var activeEntering = Data_Array.filter(function ($30) {
                return !elementComplete($30);
            })(entering$prime);
            var updating$prime = traverse(tickElement(deltaMs))(v.updating)();
            var activeUpdating = Data_Array.filter(function ($31) {
                return !elementComplete($31);
            })(updating$prime);
            var exiting$prime = traverse(tickElement(deltaMs))(v.exiting)();
            var completedExits = Data_Array.filter(elementComplete)(exiting$prime);
            var activeExiting = Data_Array.filter(function ($32) {
                return !elementComplete($32);
            })(exiting$prime);
            traverse(function (et) {
                return $foreign.removeElement(et.element);
            })(completedExits)();
            var $29 = Data_Array["null"](activeEntering) && (Data_Array["null"](activeUpdating) && Data_Array["null"](activeExiting));
            if ($29) {
                return Complete.value;
            };
            return new Running({
                entering: activeEntering,
                updating: activeUpdating,
                exiting: activeExiting
            });
        };
    };
};
export {
    HATSTransitions,
    Running,
    Complete,
    tickTransitions,
    isComplete,
    toTickEasing
};
//# sourceMappingURL=index.js.map
