// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect from "../Effect/index.js";
import * as Hylograph_HATS from "../Hylograph.HATS/index.js";
import * as Hylograph_HATS_InterpreterTick from "../Hylograph.HATS.InterpreterTick/index.js";
import * as Hylograph_Internal_Selection_Types from "../Hylograph.Internal.Selection.Types/index.js";
import * as Zoo_Chapters from "../Zoo.Chapters/index.js";
import * as Zoo_DiagramTypes from "../Zoo.DiagramTypes/index.js";
import * as Zoo_Layout from "../Zoo.Layout/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var eq = /* #__PURE__ */ Data_Eq.eq(Zoo_DiagramTypes.eqNodeRole);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var for_ = /* #__PURE__ */ Data_Foldable.for_(Effect.applicativeEffect)(Data_Foldable.foldableArray);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var zooYellow = "#FFD93D";
var zooTeal = "#00B4A0";
var zooPurple = "#845EC2";
var zooPink = "#FF78AE";
var zooOrange = "#FF6B35";
var zooGreen = "#2ECC71";
var zooCharcoal = "#2D3436";
var zooBlue = "#4D8BF5";
var starTree = function (cx) {
    return function (cy) {
        return function (color) {
            var points = "M " + (show(cx) + (" " + (show(cy - 15.0) + (" L " + (show(cx + 4.0) + (" " + (show(cy - 5.0) + (" L " + (show(cx + 15.0) + (" " + (show(cy - 5.0) + (" L " + (show(cx + 6.0) + (" " + (show(cy + 3.0) + (" L " + (show(cx + 9.0) + (" " + (show(cy + 15.0) + (" L " + (show(cx) + (" " + (show(cy + 8.0) + (" L " + (show(cx - 9.0) + (" " + (show(cy + 15.0) + (" L " + (show(cx - 6.0) + (" " + (show(cy + 3.0) + (" L " + (show(cx - 15.0) + (" " + (show(cy - 5.0) + (" L " + (show(cx - 4.0) + (" " + (show(cy - 5.0) + " Z")))))))))))))))))))))))))))))))))))))));
            return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Path.value)([ Hylograph_HATS.staticStr("d")(points), Hylograph_HATS.staticStr("fill")(color), Hylograph_HATS.staticStr("stroke")(zooCharcoal), Hylograph_HATS.staticNum("stroke-width")(2.0) ])([  ]);
        };
    };
};
var sparklesTree = /* #__PURE__ */ (function () {
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("class")("sparkles") ])([ starTree(150.0)(40.0)(zooPink), starTree(350.0)(40.0)(zooPink), starTree(250.0)(30.0)(zooYellow) ]);
})();
var roleColor = function (v) {
    if (v instanceof Zoo_DiagramTypes.Value) {
        return zooTeal;
    };
    if (v instanceof Zoo_DiagramTypes.Operator) {
        return zooOrange;
    };
    if (v instanceof Zoo_DiagramTypes.Seed) {
        return zooYellow;
    };
    if (v instanceof Zoo_DiagramTypes.Intermediate) {
        return zooBlue;
    };
    if (v instanceof Zoo_DiagramTypes.Result) {
        return zooPurple;
    };
    throw new Error("Failed pattern match at Zoo.PanelRenderer (line 50, column 13 - line 55, column 22): " + [ v.constructor.name ]);
};
var nodeTree = function (pos) {
    var glowClass = (function () {
        if (pos.node.highlight) {
            return " zoo-glow";
        };
        return "";
    })();
    var color = roleColor(pos.node.role);
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("class")("zoo-node" + glowClass) ])([ Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Circle.value)([ Hylograph_HATS.staticNum("cx")(pos.x), Hylograph_HATS.staticNum("cy")(pos.y), Hylograph_HATS.staticNum("r")(pos.radius), Hylograph_HATS.staticStr("fill")(color), Hylograph_HATS.staticStr("stroke")(zooCharcoal), Hylograph_HATS.staticNum("stroke-width")(3.0) ])([  ]), Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Text.value)([ Hylograph_HATS.staticNum("x")(pos.x), Hylograph_HATS.staticNum("y")(pos.y + 6.0), Hylograph_HATS.staticStr("text-anchor")("middle"), Hylograph_HATS.staticStr("dominant-baseline")("middle"), Hylograph_HATS.staticStr("font-family")("'Comic Sans MS', cursive"), Hylograph_HATS.staticNum("font-size")((function () {
        var $19 = pos.radius > 35.0;
        if ($19) {
            return 24.0;
        };
        return 18.0;
    })()), Hylograph_HATS.staticStr("font-weight")("bold"), Hylograph_HATS.staticStr("fill")((function () {
        var $20 = eq(pos.node.role)(Zoo_DiagramTypes.Value.value);
        if ($20) {
            return "white";
        };
        return zooCharcoal;
    })()), Hylograph_HATS.staticStr("textContent")(pos.node.label) ])([  ]) ]);
};
var nodesTree = function (nodes) {
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("class")("zoo-nodes") ])(map(nodeTree)(nodes));
};
var linkTree = function (link) {
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Line.value)([ Hylograph_HATS.staticNum("x1")(link.x1), Hylograph_HATS.staticNum("y1")(link.y1), Hylograph_HATS.staticNum("x2")(link.x2), Hylograph_HATS.staticNum("y2")(link.y2), Hylograph_HATS.staticStr("stroke")(zooCharcoal), Hylograph_HATS.staticNum("stroke-width")(3.0) ])([  ]);
};
var linksTree = function (links) {
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("class")("zoo-links") ])(map(linkTree)(links));
};
var defaultChapter = {
    morphism: "Unknown",
    tagline: "Morphism not found",
    panels: [  ]
};
var getChapter = function (name) {
    var v = Data_Array.find(function (c) {
        return c.morphism === name;
    })(Zoo_Chapters.allChapters);
    if (v instanceof Data_Maybe.Nothing) {
        return defaultChapter;
    };
    if (v instanceof Data_Maybe.Just) {
        return v.value0;
    };
    throw new Error("Failed pattern match at Zoo.PanelRenderer (line 63, column 19 - line 65, column 14): " + [ v.constructor.name ]);
};
var decorationTree = function (v) {
    if (v instanceof Zoo_DiagramTypes.Star) {
        return starTree(v.value0.x)(v.value0.y)(zooYellow);
    };
    if (v instanceof Zoo_DiagramTypes.Sparkles) {
        return sparklesTree;
    };
    if (v instanceof Zoo_DiagramTypes.Arrow) {
        return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([  ])([  ]);
    };
    throw new Error("Failed pattern match at Zoo.PanelRenderer (line 187, column 18 - line 190, column 30): " + [ v.constructor.name ]);
};
var decorationsTree = function (decorations) {
    return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.Group.value)([ Hylograph_HATS.staticStr("class")("zoo-decorations") ])(map(decorationTree)(decorations));
};
var panelTree = function (panel) {
    return function (layout) {
        return Hylograph_HATS.elem(Hylograph_Internal_Selection_Types.SVG.value)([ Hylograph_HATS.staticStr("viewBox")("0 0 " + (show(layout.width) + (" " + show(layout.height)))), Hylograph_HATS.staticStr("class")("story-diagram"), Hylograph_HATS.staticStr("width")("100%"), Hylograph_HATS.staticStr("height")("100%"), Hylograph_HATS.staticStr("preserveAspectRatio")("xMidYMid meet") ])([ linksTree(layout.links), nodesTree(layout.nodes), decorationsTree(panel.decorations) ]);
    };
};
var renderPanelToContainer = function (selector) {
    return function (panel) {
        var layout = Zoo_Layout.layoutDiagram(Zoo_Layout.defaultConfig)(panel.structure);
        return function __do() {
            Hylograph_HATS_InterpreterTick.rerender(selector)(panelTree(panel)(layout))();
            return Data_Unit.unit;
        };
    };
};
var renderChapterPanels = function (morphismName) {
    var chapter = getChapter(morphismName);
    var indexedPanels = Data_Array.mapWithIndex(function (i) {
        return function (p) {
            return {
                index: i,
                panel: p
            };
        };
    })(chapter.panels);
    return for_(indexedPanels)(function (v) {
        return renderPanelToContainer("#panel-" + show1(v.index))(v.panel);
    });
};
export {
    zooOrange,
    zooTeal,
    zooPurple,
    zooYellow,
    zooPink,
    zooBlue,
    zooCharcoal,
    zooGreen,
    roleColor,
    getChapter,
    defaultChapter,
    renderChapterPanels,
    renderPanelToContainer,
    panelTree,
    linksTree,
    linkTree,
    nodesTree,
    nodeTree,
    decorationsTree,
    decorationTree,
    starTree,
    sparklesTree
};
//# sourceMappingURL=index.js.map
